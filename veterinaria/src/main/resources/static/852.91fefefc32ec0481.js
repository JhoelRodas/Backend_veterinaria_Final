"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[852],{46852:(Et,E,a)=>{a.r(E),a.d(E,{VentaModule:()=>Ft});var h=a(60177),D=a(18498),l=a(9159),s=a(89417),d=a(34006),t=a(17705),k=a(97405),C=a(52920),x=a(99631),u=a(86467),f=a(88834);function G(e,r){1&e&&(t.j41(0,"th",20),t.EFF(1," Producto "),t.k0s())}function N(e,r){if(1&e&&(t.j41(0,"td",21),t.EFF(1),t.k0s()),2&e){const o=r.$implicit;t.R7$(1),t.SpI(" ",o.idProducto," ")}}function A(e,r){1&e&&(t.j41(0,"th",20),t.EFF(1," Cantidad "),t.k0s())}function P(e,r){if(1&e&&(t.j41(0,"td",21),t.EFF(1),t.k0s()),2&e){const o=r.$implicit;t.R7$(1),t.SpI(" ",o.cant," ")}}function Y(e,r){1&e&&(t.j41(0,"th",20),t.EFF(1," Monto "),t.k0s())}function w(e,r){if(1&e&&(t.j41(0,"td",21),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&e){const o=r.$implicit;t.R7$(1),t.SpI(" ",t.bMT(2,1,o.monto)," ")}}function M(e,r){1&e&&t.nrm(0,"tr",22)}function z(e,r){1&e&&t.nrm(0,"tr",23)}let B=(()=>{class e{constructor(o,n,i){this.data=o,this.dialogRef=n,this.apiClient=i,this.detalles=[],this.dataSource=new l.I6([]),this.displayedColumns=["idProducto","cant","monto"]}ngOnInit(){this.form=new s.J3({id:new s.hs(this.data.id),ci:new s.hs(this.data.ci),nombre:new s.hs(this.data.nombre),fecha:new s.hs(this.data.fecha),montoTotal:new s.hs(this.data.montoTotal),metodoPago:new s.hs(this.data.metodoPago)}),console.log("idRecibo",this.data.id),this.apiClient.getRequest("/api/recibo/getRecibo",{id:this.data.id}).subscribe({next:o=>{console.info("ReciboCompleto",o),this.dataSource.data=o.detalles},error:o=>{console.error(o)}})}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||e)(t.rXU(d.Vh),t.rXU(d.CP),t.rXU(k.f))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["fury-crear-actualizar-detalles"]],decls:44,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],["fxLayout","column wrap"],["fxFlex",""],["matInput","","formControlName","id","readonly",""],["matInput","","formControlName","ci","readonly",""],["matInput","","formControlName","nombre","readonly",""],["matInput","","formControlName","fecha","readonly",""],["matInput","","formControlName","montoTotal","readonly",""],["matInput","","formControlName","metodoPago","readonly",""],[2,"text-align","right","margin-top","15px"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8",2,"width","100%","margin-top","20px",3,"dataSource"],["matColumnDef","idProducto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","cant"],["matColumnDef","monto"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(n,i){1&n&&(t.j41(0,"div",0),t.EFF(1," Informacion Completa del Recibo "),t.k0s(),t.j41(2,"form",1)(3,"mat-dialog-content")(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"id"),t.k0s(),t.nrm(8,"input",4),t.k0s(),t.j41(9,"mat-form-field",3)(10,"mat-label"),t.EFF(11,"ci"),t.k0s(),t.nrm(12,"input",5),t.k0s(),t.j41(13,"mat-form-field",3)(14,"mat-label"),t.EFF(15,"nombre"),t.k0s(),t.nrm(16,"input",6),t.k0s(),t.j41(17,"mat-form-field",3)(18,"mat-label"),t.EFF(19,"fecha"),t.k0s(),t.nrm(20,"input",7),t.k0s(),t.j41(21,"mat-form-field",3)(22,"mat-label"),t.EFF(23,"montoTotal"),t.k0s(),t.nrm(24,"input",8),t.k0s(),t.j41(25,"mat-form-field",3)(26,"mat-label"),t.EFF(27,"metodoPago"),t.k0s(),t.nrm(28,"input",9),t.k0s()(),t.j41(29,"div",10)(30,"button",11),t.bIt("click",function(){return i.closeDialog()}),t.EFF(31,"Cerrar"),t.k0s()(),t.j41(32,"table",12),t.qex(33,13),t.DNE(34,G,2,0,"th",14),t.DNE(35,N,2,1,"td",15),t.bVm(),t.qex(36,16),t.DNE(37,A,2,0,"th",14),t.DNE(38,P,2,1,"td",15),t.bVm(),t.qex(39,17),t.DNE(40,Y,2,0,"th",14),t.DNE(41,w,3,3,"td",15),t.bVm(),t.DNE(42,M,1,0,"tr",18),t.DNE(43,z,1,0,"tr",19),t.k0s()()()),2&n&&(t.R7$(2),t.Y8G("formGroup",i.form),t.R7$(30),t.Y8G("dataSource",i.dataSource),t.R7$(10),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",i.displayedColumns))},dependencies:[s.qT,s.me,s.BC,s.cb,s.j4,s.JD,C.DJ,C.UI,d.BI,d.Yi,x.fg,u.rl,u.nJ,f.$z,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,h.oe]})}}return e})();var _=a(10467),V=a(2578);const X=new class U{downloadFromBase64(r,o,n){const c=atob(r),m=[];for(let b=0;b<c.length;b+=512){const v=c.slice(b,b+512),S=new Array(v.length);for(let y=0;y<v.length;y++)S[y]=v.charCodeAt(y);const vt=new Uint8Array(S);m.push(vt)}const Rt=new Blob(m,{type:n});(0,V.saveAs)(Rt,o)}downloadTextAsFile(r,o){const n=new Blob([r],{type:"text/plain;charset=utf-8"});(0,V.saveAs)(n,o)}fileToBase64(r){return new Promise((o,n)=>{const i=new FileReader;i.readAsDataURL(r),i.onload=()=>o(`${i.result}`),i.onerror=()=>n("Error al leer el archivo")})}fileToByteArray(r){return(0,_.A)(function*(){return Array.from(new Uint8Array(yield r.arrayBuffer()))})()}};var H=a(97586),j=a.n(H),J=a(74061),L=a(75063),T=a(82765),p=a(25084),F=a(99213),g=a(59115),$=a(96695),R=a(2042),O=a(43655),Z=a(53007),K=a(15551);function Q(e,r){1&e&&(t.j41(0,"mat-error"),t.EFF(1,"Fecha de inicio inv\xe1lida"),t.k0s())}function W(e,r){1&e&&(t.j41(0,"mat-error"),t.EFF(1,"Fecha de fin inv\xe1lida"),t.k0s())}function q(e,r){1&e&&(t.j41(0,"th",24)(1,"mat-checkbox",25),t.bIt("click",function(n){return n.stopPropagation()}),t.k0s()())}function tt(e,r){1&e&&(t.j41(0,"td",26)(1,"mat-checkbox",25),t.bIt("click",function(n){return n.stopPropagation()}),t.k0s()())}function et(e,r){if(1&e&&(t.j41(0,"th",31),t.EFF(1),t.k0s()),2&e){const o=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",o.name,"")}}function ot(e,r){if(1&e&&(t.j41(0,"td",32),t.EFF(1),t.k0s()),2&e){const o=r.$implicit,n=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",o[n.property]," ")}}function nt(e,r){if(1&e&&(t.qex(0,28),t.DNE(1,et,2,1,"th",29),t.DNE(2,ot,2,1,"td",30),t.bVm()),2&e){const o=t.XpG().$implicit;t.Y8G("matColumnDef",o.property)}}function at(e,r){if(1&e&&(t.qex(0),t.DNE(1,nt,3,1,"ng-container",27),t.bVm()),2&e){const o=r.$implicit;t.R7$(1),t.Y8G("ngIf",o.isModelProperty)}}function rt(e,r){1&e&&t.nrm(0,"th",33)}function it(e,r){if(1&e){const o=t.RV6();t.j41(0,"td",26)(1,"button",34),t.bIt("click",function(i){return i.stopPropagation()}),t.j41(2,"mat-icon"),t.EFF(3,"more_horiz"),t.k0s()(),t.j41(4,"mat-menu",35,36)(6,"button",37),t.bIt("click",function(){const c=t.eBV(o).$implicit,m=t.XpG();return t.Njj(m.verDetalles(c))}),t.j41(7,"span"),t.EFF(8,"Ver Detalles"),t.k0s()(),t.j41(9,"button",37),t.bIt("click",function(){const c=t.eBV(o).$implicit,m=t.XpG();return t.Njj(m.anularRecibo(c))}),t.j41(10,"span"),t.EFF(11,"Anular"),t.k0s()()()()}if(2&e){const o=t.sdS(5);t.R7$(1),t.Y8G("matMenuTriggerFor",o)}}function lt(e,r){1&e&&t.nrm(0,"tr",38)}function st(e,r){if(1&e){const o=t.RV6();t.j41(0,"tr",39),t.bIt("click",function(){const c=t.eBV(o).$implicit,m=t.XpG();return t.Njj(m.verDetalles(c))}),t.k0s()}}const ct=function(){return["Recibos"]},mt=function(){return[]},ut=[{path:"",component:(()=>{class e{constructor(o,n,i){this.apiClient=o,this.dialog=n,this.router=i,this.dataSource=new l.I6([]),this.columns=[{name:"ID",property:"id",visible:!0,isModelProperty:!0},{name:"Cliente",property:"nombre",visible:!0,isModelProperty:!0},{name:"Ci",property:"ci",visible:!0,isModelProperty:!0},{name:"Fecha",property:"fecha",visible:!0,isModelProperty:!0},{name:"Monto Total",property:"montoTotal",visible:!0,isModelProperty:!0},{name:"Metodo de pago",property:"metodoPago",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10,this.form=new s.gE({from:new s.MJ(j()().subtract(10,"days").toDate()),to:new s.MJ(j()().toDate())})}get visibleColumns(){return this.columns.filter(o=>o.visible).map(o=>o.property)}ngOnInit(){this.getRecibos()}onFilterChange(o){console.info(event),this.dataSource&&(o=(o=o.trim()).toLowerCase(),this.dataSource.filter=o)}getRecibos(){this.apiClient.getRequest("/api/recibo").subscribe({next:o=>{this.dataSource.data=o,console.log(o)},error:o=>{console.error(o)}})}createRecibo(){this.router.navigate(["/detallesVenta"]).then(()=>{this.getRecibos()})}generarReporte(){const o={filtros:this.form.value,headers:[...this.columns],tipoReporte:"Ventas"};console.log(o),this.apiClient.postRequest("/api/reporte/generar-excel",o).subscribe({next:n=>{console.log(n),X.downloadFromBase64(n.base64Archivo,"excel.xlsx",n.tipoRespaldo)}})}anularRecibo(o){this.apiClient.deleteRequest(o.id,"/api/recibo").subscribe({next:n=>{this.getRecibos()},error:n=>{}})}verDetalles(o){console.info(o),this.dialog.open(B,{data:o,width:"400px"})}static{this.\u0275fac=function(n){return new(n||e)(t.rXU(k.f),t.rXU(d.bZ),t.rXU(D.Ix))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["fury-venta"]],decls:35,vars:14,consts:[["mode","card"],["current","Recibo",3,"crumbs"],["name","Recibo",3,"columns","filterChange"],[1,"actions"],["fxLayout","row","fxLayoutGap","16px"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["type","button","mat-raised-button","","color","primary",1,"generarReporte",3,"click"],["fxLayout","row wrap",3,"formGroup"],[3,"rangePicker"],["matStartDate","","formControlName","from","placeholder","Inicio"],["matEndDate","","formControlName","to","placeholder","Fin"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","checkbox"],["class","actions-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],["mat-header-cell","",1,"actions-cell"],["color","primary",3,"click"],["mat-cell","",1,"actions-cell"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(n,i){if(1&n&&(t.j41(0,"fury-page-layout",0)(1,"fury-page-layout-header"),t.nrm(2,"fury-breadcrumbs",1),t.k0s(),t.j41(3,"fury-page-layout-content")(4,"fury-list",2),t.bIt("filterChange",function(m){return i.onFilterChange(m)}),t.j41(5,"div",3)(6,"div",4)(7,"button",5),t.bIt("click",function(){return i.createRecibo()}),t.j41(8,"mat-icon"),t.EFF(9,"add"),t.k0s()(),t.j41(10,"button",6),t.bIt("click",function(){return i.generarReporte()}),t.EFF(11," Generar Reporte "),t.k0s()()(),t.j41(12,"div",7)(13,"mat-form-field")(14,"mat-label"),t.EFF(15,"Rango de fecha"),t.k0s(),t.j41(16,"mat-date-range-input",8),t.nrm(17,"input",9)(18,"input",10),t.k0s(),t.nrm(19,"mat-datepicker-toggle",11)(20,"mat-date-range-picker",null,12),t.DNE(22,Q,2,0,"mat-error",13),t.DNE(23,W,2,0,"mat-error",13),t.k0s()(),t.j41(24,"table",14),t.qex(25,15),t.DNE(26,q,2,0,"th",16),t.DNE(27,tt,2,0,"td",17),t.bVm(),t.DNE(28,at,2,1,"ng-container",18),t.qex(29,19),t.DNE(30,rt,1,0,"th",20),t.DNE(31,it,12,1,"td",17),t.bVm(),t.DNE(32,lt,1,0,"tr",21),t.DNE(33,st,1,0,"tr",22),t.k0s(),t.nrm(34,"mat-paginator",23),t.k0s()()()),2&n){const c=t.sdS(21);t.R7$(2),t.Y8G("crumbs",t.lJ4(12,ct)),t.R7$(2),t.Y8G("columns",t.lJ4(13,mt)),t.R7$(8),t.Y8G("formGroup",i.form),t.R7$(4),t.Y8G("rangePicker",c),t.R7$(3),t.Y8G("for",c),t.R7$(3),t.Y8G("ngIf",i.form.controls.from.hasError("matStartDateInvalid")),t.R7$(1),t.Y8G("ngIf",i.form.controls.to.hasError("matEndDateInvalid")),t.R7$(1),t.Y8G("dataSource",i.dataSource),t.R7$(4),t.Y8G("ngForOf",i.columns),t.R7$(4),t.Y8G("matHeaderRowDef",i.visibleColumns),t.R7$(1),t.Y8G("matRowDefColumns",i.visibleColumns),t.R7$(1),t.Y8G("pageSize",i.pageSize)}},dependencies:[h.Sq,h.bT,J.m,C.DJ,C.BO,L.s,f.$z,f.iY,f.$0,T.So,p.bU,p.el,p.xR,p.IG,p.SG,u.rl,u.nJ,u.TL,u.yw,F.An,g.kk,g.fb,g.Cp,$.iy,R.B4,R.aE,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,O.T,Z.M,K.M,s.me,s.BC,s.cb,s.j4,s.JD]})}}return e})()}];let dt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[D.iI.forChild(ut),D.iI]})}}return e})();var ft=a(3632),pt=a(91398),ht=a(86600),I=a(82798),Ct=a(49320),gt=a(14823),bt=a(26924),yt=a(5951);let Dt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[h.MD,s.YN,s.X1,bt.YF,d.hM,x.fS,f.Hl,F.m_,yt.Wk,I.Ve,l.tP]})}}return e})(),Ft=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[h.MD,dt,ft.V,C.w2,pt.H,f.Hl,T.g7,p.X6,u.RG,F.m_,g.Cn,ht.Sy,$.Ou,I.Ve,R.NQ,l.tP,Ct.S,s.X1,gt.uc,Dt]})}}return e})()}}]);